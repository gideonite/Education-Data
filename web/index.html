<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Brooklyn Education Data</title>
<!--
<link rel="stylesheet" type="text/css" href="FIXME" />
<script type="text/javascript" src="FIXME"></script>
<style type="text/css">
/* <![CDATA[ */
/* ]]> */
</style>
<link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0-rc2/css/bootstrap-glyphicons.css" rel="stylesheet">
-->
<style type="text/css">

    .brush .extent {
        fill-opacity: .3;
        stroke: #fff;
        shape-rendering: crispEdges;
    }

    .background path {
        fill: none;
        stroke: #ccc;
        stroke-opacity: .4;
        shape-rendering: crispEdges;
    }

    .foreground path {
        fill: none;
        stroke: steelblue;
        stroke-opacity: .7;
    }

    .axis line, .axis path {
        fill: none;
        stroke: #000;
        shape-rendering: crispEdges;
    }
</style>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0-rc2/css/bootstrap.min.css" rel="stylesheet">
<script src="//netdna.bootstrapcdn.com/bootstrap/3.0.0-rc2/js/bootstrap.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/d3/3.2.2/d3.v3.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.1/underscore-min.js"></script>
<script type="text/javascript" src="js/parallel-coordinates.js"></script>
</head>
<body>

    <div class="container">
        <h1>Brooklyn Public School Data</h1>

        <h2>Survey Questions</h2>

        <select id="selector">
        </select>

        <div id="question-bar-chart"></div>
        <script type="text/javascript" src="js/barchart.js"></script>
    </div>

<script type="text/javascript">

    var Data = {};
    function get_parent_score() {
        return $.get("json/parent-score.json", function(data) {
            _.extend(Data, data);
        })
    }

    function get_student_score() {
        return $.get("json/student-score.json", function(data) {
            _.extend(Data, data);
        })
    }

    function get_teacher_score() {
        return $.get("json/teacher-score.json", function(data) {
            _.extend(Data, data);
        })
    }

    var $container = $('.container');
    var bar_chart_el = document.getElementById('question-bar-chart');
    $selector = $("#selector");

    $container.hide();
    $.when(get_parent_score(), get_student_score(), get_teacher_score())
        .done(function(data) {
                _.chain(Data)
                .keys()
                .each(function(k) {
                    var option = $('<option>').text(k);
                    $selector.append(option);
                })

                $container.show();
            });

    $selector.change(function() {
            bar_chart_el.innerHTML = "";         // reset
            Barchart(Data[$selector.val()], bar_chart_el);
    });

</script>
</body>
</html>
